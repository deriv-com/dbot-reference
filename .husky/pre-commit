#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "ğŸ” Running pre-commit checks..."
echo ""

# TODO: will uncommit after fixed
# # 1. TypeScript Type Checking
# echo "ğŸ“˜ Checking TypeScript types..."
# npm run type-check
# TYPE_CHECK_EXIT=$?

# if [ $TYPE_CHECK_EXIT -ne 0 ]; then
#   echo "âŒ TypeScript type check failed. Please fix type errors before committing."
#   exit 1
# fi
# echo "âœ… TypeScript types are valid"
# echo ""

# # 2. Linting
# echo "ğŸ”§ Running linter..."
# npm run test:lint
# LINT_EXIT=$?

# if [ $LINT_EXIT -ne 0 ]; then
#   echo "âŒ Linting failed. Please fix linting issues before committing."
#   exit 1
# fi
# echo "âœ… Linting passed"
# echo ""

# 3. ShiftAI Pre-commit Hook - Detect and strip AI markers
echo "ğŸ¤– Running ShiftAI hook..."
npx @deriv-com/shiftai-cli hook pre-commit
SHIFTAI_EXIT=$?

if [ $SHIFTAI_EXIT -ne 0 ]; then
  echo "âŒ ShiftAI hook failed"
  exit 1
fi
echo "âœ… ShiftAI hook passed"
echo ""

echo "âœ¨ All pre-commit checks passed!"
exit 0